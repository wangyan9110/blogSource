title: '如何做详细设计之理解业务本质'
date: 2014-12-31 23:16:18
categories:
	- detailed design
tags:
	- Design pattern
	- java
	- detailed design
---
今天来讨论详细设计中的一个重要的能力，理解业务的本质。在本系列第一篇，我们提到详细设计人员需要具备的三种能力中，其中有一条就是理解业务的本质。在做业务系统的开发中，业务是我们的核心，不管我们使用什么技术、什么设计目的只有一个为我们的业务服务。所以光有技术不行，没有业务分析能力，还是成为不了一名好的软件开发工程师。写到这里我思考了很长时间，如何来介绍本篇的内容。经过思考，我决定从深入分析业务用例、抽象公共业务模块两个工作中遇到过业务分析实例来讲解。
####深入分析业务用例
在产品研发中，通常是由产品经理画出产品原型，然后进行产品原型讲解，或者出一个需求列表。研发根据原型进行分析设计，当然对于简单的需求，可以直接的看出业务用例。对于复杂的模块业务用例不容易直接看出，这时就能体现出设计者的业务分析能力的时候了，在目前做的产品中，有两个功能比较复杂，需要做详细的业务分析。我们以其中一个也是前面多次提到的阅卷模块（另一个是答题卡生成工具）。<!--more-->阅卷功能在我们系统中只有一个画面，有如下功能：教师进入阅卷画面后，可以加载一道该老师阅的试题，然后老师可以打分，打分完成后，并加载下一题，界面上可以显示老师已阅人数以及任务量。支持老师回评（即老师阅卷完成一份后，可以回到上一份），以及重评（即老师可以搜索自己的阅卷记录，然后直接跳到该题阅卷）功能。
分析：从以上描述中可以看出阅卷业务有以下业务用例：加载试题，提交分数，阅卷进度，任务量，回评，重评这几个用例。大家可以看出我刚才写的业务用例是就是在找以上需求描述中的关键词，但是这个用例的划分是有问题的。需要更加详细，大家注意着这几个，加载试题，回评，重评这三个功能，其实有着共同的特点即：加载一道题，提交分数。不管是怎么正常阅卷还是回评，重评总归有着加载试题，正常阅卷就是加载下一份未阅试题，回评中上一份，就是加载上一份试题，下一份就是加载下一份试题，重评就是加载指定一份试题。对于提交分数，不管怎么着都是提交分数所以就是一个用例。以上对于加载试卷的分析对于前后台交互接口的设计是完全没有问题的。但是对于我们关注的业务层的设计，以上分析还不够。我们再来看加载回评中的上一份试题，加载回评中的下一份试题，重评时的加载指定一份试题。我们想回评其实就是自己的阅卷历史中的一份，我们可以知道当前的试题编号，就应该指导上一份试题以及下一份试题的编号，所以就变成了加载指定一份试题的接口。所以在底层业务接口上，加载试题就两个接口，一个加载一份未阅试题，另一个是加载指定的试题。（在实际的系统中还有其他条件限制，底层有三个加载试题方法）。
从以上分析可以看出，业务分析需要我们一步一步的推导思考其业务的本质，增加对业务的理解以及推导。进而设计出优秀的接口。

####抽象公共业务模块
在做软件开发中，特别是在产品不断迭代中，会发现有很多需求属于同类需求，每次都要写很多类似的代码。这些代码的逻辑大致相同。这时就基本上能够感知到，这部分可以抽象成公共代码。因为这些功能在本质上有一致的功能。同样举个我做过的一个例子。在我们这边有一个档案模块，有一个功能就是显示题目的试题解析，还有一个显示答题情况。因为基础数据在变，在多次功能修改时，我发现了都要修改几个地方几乎相同的代码。由于两个功能从产品上看是两个完全不同的功能。刚开始没有发现其共性，经过思考，两个接口有一个共同特点就是需要加载一张试卷的试题解析，然后分别加载不同的统计数据组合一个对象，然后返回给前端。所以就抽象出了一个专门用于组装一张试卷的试题解析的接口。然后根据不同的需求组装相应的统计数据即可。还有一个例子由于讲清楚比较复杂，也是抽象出了一个任务模块，后来新的需求可以轻而易举的解决。
所以在需求分析时，需要深入的思考其业务本质，从而抽象出公用模块，从而使我们的设计更加灵活，以应对不同的需求。

####理解业务的本质
以上两个例子都是在我在工作中遇到的并解决的问题。在需求分析时，不能武断的下出结论，需要经过深入的思考和分析，思考业务的本质。才能做出好的详细设计。之所以把理解业务的本质作为本系列的单独的一篇来介绍，就是就是业务是我们的核心，对业务的理解直接决定了详细设计的好坏。理解分析业务是考验我们设计能力的最重要的一部分。因为其他部分基本上有规律可循，业务分析是无规律的，特别是对我们刚工作一两年的小菜，做的业务分析比较少，所以在设计时更加需要注意思考业务的本质，同时提高自己的业务分析能力。 这是本年度最后一篇，快要跨年了^_^，先到这里吧。

本篇内容是在平常工作中的实践思考与总结。如有不妥之处，欢迎讨论。