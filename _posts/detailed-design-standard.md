title: '如何做详细设计之规范'
date: 2014-12-23 23:26:27
categories:
	- detailed design
tags:
	- Design pattern
	- java
	- detailed design
---
在软件开发中，很多时候都在讲规范，一般至少一个团队需要一致的规范。当然讲到规范很多人也可能想到驼峰规则、匈牙利命名法，今天我们不谈这些命名法则，遵守这些基本的法则，是做为一个程序员必备的素质。我们主要谈一些如何起名，参数列表一致性，善用注释、接口方法顺序等有趣的话题。详细设计规范了，接口实现者、接口调用者才能更好的理解接口。
####起名难吗？
如果你认真的为一个方法名或者一个类名思考过或者纠结过，说明我们都在为起一个好名字而努力。以下是个人就一些场景起名的一个看法。
1. 业务领域类，或者叫实体类，首先类名需要能够准确表达领域类的意图，比如我们一个领域类，School类，我们不可能拿它来表示班级。这是最简单的情况。
   * 具备共性的领域类，使用相同的结尾或者开头，比如Archive类，档案类，另外我们根据学生、班级、学校各有一个档案的领域类，这就是一个档案类的族，我们叫UserArchive、ClassArchive、SchoolArchive等。<!--more-->
   * 具有对应关系的领域类，使用相同的开头，比如Order类，订单类，通常订单类还需要一个订单详情类，我们叫OrderDetail类。
2. 业务接口名
   * 业务接口类，和详细设计者的抽象设计有关，不过一般业务接口类都有一个门面，门面类名字需要和具体的业务模块用例相关。比如阅卷门面接口类，我们就可以叫MarkingService。当然也有些不一定和业务用例有关，是设计者为实现某个用例，抽象出来的接口，比如以上的阅卷业务类，部分业务接口比较复杂，需要继续抽象。我们抽象出来一个阅卷任务类，我们就可以叫MarkingTask，当然MarkingTask不能被外部调用。需要通过门面接口类MarkingService对外提供服务。
   * 业务接口方法，业务接口方法和业务用例相关。比如我们有个业务用例是生成档案，我们就叫generateArchive，这个名字和业务相关。
3. 数据持久层接口名
   * 一般持久层接口设计比较轻，这个具体的接口设计原则，会在下次讲到。接口方法设计，一般几个固定开头就够用了，比如：insert,update,delete,find开头就够用。比如查询一条用户档案就叫findUserArchive。

####顺序重要吗？
不知大家有没有思考过，类中字段顺序、接口方法顺序的问题。我个人思考过这个问题，但是我自己在工作中，也做的不好。
1. 属性的顺序，比如两个类有几个相同的属性（不考虑是否需要抽离到一个Base的抽象类中），在一个类中，把它们放在开头，另一个类中放在后面，当自己的调试一些问题，或者别人阅读时总是不方便，不好找。建议表达相近的属性放在一块，并保持顺序一致，比如表达个人信息的基础信息（userId,userCode,userName）放在连续顺序。所以字段顺序保持一致性也是非常好的习惯。
2. 方法的顺序，和字段同样的问题，比如两个重载方法，方法名一致，参数列表不同，如果把一个放在开头，另一个放在结尾。看着肯定累。
建议，表达相近业务的方法放在连续，并保持顺序一致。比如获取档案列表接口getUserArchive() getUserArchivesByClassId,getUserArchivesBySchoolId就可以保持连续。
3. 参数列表一致性,定义接口时参数列表的顺序不知道大家有没有注意过，比如两个接口，一个接口方法A(String userId,String classId)，接口方法B(String classId,String userId)，两个相同的接口，参数列表不同，首先我们从调用者的角度考虑，非常容易把参数写反，造成不必要的问题。另外查看我们的接口列表也会非常奇怪。
所以在参数相近的接口，一定需要注意参数列表的顺序。

####善用注释
在设计接口时，特别是业务接口方法时，通常不能通过简单的英文单词就能表达接口的意思。这时我们需要考虑两点，第一这个接口职责单一吗？第二如何起个好名字?当然第一种情况就是需要检查接口是否合理，第二种情况就需要我们在方法名和注释和权衡。
比如有这样一个接口，获取某个学生每个学科最近一次的考试分数以及排名。如果我们完全按照字面意思来写方法名如下：getStudentEverySubjectsRecentlyScoreAndRank(),显然这不是个好名字.
遇到以上情况，我们需要思考如下：
1、业务接口方法解决的主要问题是干什么？
2、可不可以通过方法参数列表或者返回值来更好的表达？
以上需求最主要表达是获取学生成绩。我们在来看用户分以及排名应该是个DTO，我们叫UserScoreDTO，所以DTO可以用类表示用户的成绩。我们在看传入参数，应该为一个userId表示学生，所以通过以上我们可以变成如下接口List<UserScoreDTO> getEverySubjectsRecently(String userId);
以上名字依然不好，可能看到这个接口之后，更晕了，还不通顺。这时候注释就派上了用场。以上的EverySubjectsRecently可以通过注释类描述。我们接口就变成List<UserScoreDTO> get(String userId)或者叫List<UserScoreDTO> getUserScores(String userId);这个接口最终如下：
```java
    /**
     * 获取某个学生每个学科最近一次的考试成绩。
     * <p>
     *     仅返回有答题记录的用户的学科。
     * </p>
     * @param userId 用户id
     * @return 用户成绩
     */
    List<UserScoreDTO> getUserScores(String userId);
```
####其他
1. 尽量不要使用缩写，除非团队规定
2. 开启代码检查工具，比如java的checkstyle，避免手误。

本篇内容是在平常工作中的实践思考与总结。如有不妥之处，欢迎讨论。
